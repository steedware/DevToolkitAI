<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Dev Toolkit</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .feature-card { margin-bottom: 20px; }
        .response-area { max-height: 400px; overflow-y: auto; }
        .navbar-brand { font-weight: bold; }
        .loading { display: none; }
    </style>
</head>
<body>
    <nav class="navbar navbar-dark bg-dark">
        <div class="container">
            <span class="navbar-brand">ü§ñ AI Dev Toolkit</span>
            <span class="navbar-text">by steedware</span>
        </div>
    </nav>

    <div class="container mt-4">
        <div class="row">
            <div class="col-md-12">
                <h1 class="text-center mb-4">AI-Powered Development Assistant</h1>
                <p class="text-center text-muted">Leverage AI to enhance your development workflow</p>
            </div>
        </div>

        <!-- Code Review Feature -->
        <div class="row feature-card">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-header">
                        <h5>üîç Code Reviewer</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">File Name</label>
                                    <input type="text" class="form-control" id="reviewFileName" placeholder="Example.java">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Java Code</label>
                                    <textarea class="form-control" id="reviewCode" rows="8" placeholder="public class Example { ... }"></textarea>
                                </div>
                                <button class="btn btn-primary" onclick="reviewCode()">Review Code</button>
                                <div class="loading" id="reviewLoading">
                                    <div class="spinner-border spinner-border-sm" role="status"></div> Analyzing...
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="response-area">
                                    <pre id="reviewResponse" class="bg-light p-3 rounded">Review results will appear here...</pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Test Generation Feature -->
        <div class="row feature-card">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-header">
                        <h5>üß™ Test Generator</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Class Name</label>
                                    <input type="text" class="form-control" id="testClassName" placeholder="Calculator">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Java Code</label>
                                    <textarea class="form-control" id="testCode" rows="8" placeholder="public class Calculator { ... }"></textarea>
                                </div>
                                <button class="btn btn-success" onclick="generateTests()">Generate Tests</button>
                                <div class="loading" id="testLoading">
                                    <div class="spinner-border spinner-border-sm" role="status"></div> Generating...
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="response-area">
                                    <pre id="testResponse" class="bg-light p-3 rounded">Generated tests will appear here...</pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Commit Message Feature -->
        <div class="row feature-card">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-header">
                        <h5>üìù Commit Message Generator</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Git Diff</label>
                                    <textarea class="form-control" id="commitDiff" rows="8" placeholder="diff --git a/file.java b/file.java..."></textarea>
                                </div>
                                <button class="btn btn-warning" onclick="generateCommit()">Generate Commit Message</button>
                                <div class="loading" id="commitLoading">
                                    <div class="spinner-border spinner-border-sm" role="status"></div> Generating...
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="response-area">
                                    <pre id="commitResponse" class="bg-light p-3 rounded">Commit messages will appear here...</pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bug Explainer Feature -->
        <div class="row feature-card">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-header">
                        <h5>üêõ Bug Explainer</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Stack Trace</label>
                                    <textarea class="form-control" id="bugStackTrace" rows="6" placeholder="Exception in thread..."></textarea>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Code Context (Optional)</label>
                                    <textarea class="form-control" id="bugCodeContext" rows="4" placeholder="Related code snippet..."></textarea>
                                </div>
                                <button class="btn btn-danger" onclick="explainBug()">Explain Bug</button>
                                <div class="loading" id="bugLoading">
                                    <div class="spinner-border spinner-border-sm" role="status"></div> Analyzing...
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="response-area">
                                    <pre id="bugResponse" class="bg-light p-3 rounded">Bug explanation will appear here...</pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Interview Simulator Feature -->
        <div class="row feature-card">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-header">
                        <h5>üíº Interview Simulator</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Interview Question</label>
                                    <textarea class="form-control" id="interviewQuestion" rows="3" placeholder="What is polymorphism in Java?"></textarea>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Your Answer</label>
                                    <textarea class="form-control" id="interviewAnswer" rows="5" placeholder="Your answer to the question..."></textarea>
                                </div>
                                <div class="row">
                                    <div class="col-md-6">
                                        <label class="form-label">Role</label>
                                        <select class="form-control" id="interviewRole">
                                            <option>Java Developer</option>
                                            <option>Senior Developer</option>
                                            <option>Software Engineer</option>
                                            <option>Full Stack Developer</option>
                                        </select>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Level</label>
                                        <select class="form-control" id="interviewLevel">
                                            <option>Junior</option>
                                            <option>Mid</option>
                                            <option>Senior</option>
                                        </select>
                                    </div>
                                </div>
                                <br>
                                <button class="btn btn-info" onclick="evaluateAnswer()">Evaluate Answer</button>
                                <div class="loading" id="interviewLoading">
                                    <div class="spinner-border spinner-border-sm" role="status"></div> Evaluating...
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="response-area">
                                    <pre id="interviewResponse" class="bg-light p-3 rounded">Interview feedback will appear here...</pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <footer class="text-center mt-5 mb-3">
            <p class="text-muted">
                AI Dev Toolkit by <strong>steedware</strong> |
                <a href="/swagger-ui.html" target="_blank">API Documentation</a>
            </p>
        </footer>
    </div>

    <script>
        // Show/hide loading indicators
        function showLoading(id) {
            document.getElementById(id + 'Loading').style.display = 'inline-block';
        }

        function hideLoading(id) {
            document.getElementById(id + 'Loading').style.display = 'none';
        }

        // Code Review Function
        async function reviewCode() {
            const code = document.getElementById('reviewCode').value;
            const fileName = document.getElementById('reviewFileName').value;

            if (!code.trim()) {
                alert('Please enter code to review');
                return;
            }

            showLoading('review');
            try {
                const response = await fetch('/api/review', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        code: code,
                        fileName: fileName || 'Unknown.java',
                        language: 'java'
                    })
                });

                const result = await response.json();
                document.getElementById('reviewResponse').textContent = JSON.stringify(result, null, 2);
            } catch (error) {
                document.getElementById('reviewResponse').textContent = 'Error: ' + error.message;
            }
            hideLoading('review');
        }

        // Test Generation Function
        async function generateTests() {
            const code = document.getElementById('testCode').value;
            const className = document.getElementById('testClassName').value;

            if (!code.trim() || !className.trim()) {
                alert('Please enter both code and class name');
                return;
            }

            showLoading('test');
            try {
                const response = await fetch('/api/tests/generate', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        code: code,
                        className: className,
                        testFramework: 'junit5'
                    })
                });

                const result = await response.json();
                document.getElementById('testResponse').textContent = JSON.stringify(result, null, 2);
            } catch (error) {
                document.getElementById('testResponse').textContent = 'Error: ' + error.message;
            }
            hideLoading('test');
        }

        // Commit Message Function
        async function generateCommit() {
            const gitDiff = document.getElementById('commitDiff').value;

            if (!gitDiff.trim()) {
                alert('Please enter git diff');
                return;
            }

            showLoading('commit');
            try {
                const response = await fetch('/api/commit/message', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        gitDiff: gitDiff,
                        conventionType: 'conventional'
                    })
                });

                const result = await response.json();
                document.getElementById('commitResponse').textContent = JSON.stringify(result, null, 2);
            } catch (error) {
                document.getElementById('commitResponse').textContent = 'Error: ' + error.message;
            }
            hideLoading('commit');
        }

        // Bug Explainer Function
        async function explainBug() {
            const stackTrace = document.getElementById('bugStackTrace').value;
            const codeContext = document.getElementById('bugCodeContext').value;

            if (!stackTrace.trim()) {
                alert('Please enter stack trace');
                return;
            }

            showLoading('bug');
            try {
                const response = await fetch('/api/bug/explain', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        stackTrace: stackTrace,
                        codeContext: codeContext,
                        language: 'java'
                    })
                });

                const result = await response.json();
                document.getElementById('bugResponse').textContent = JSON.stringify(result, null, 2);
            } catch (error) {
                document.getElementById('bugResponse').textContent = 'Error: ' + error.message;
            }
            hideLoading('bug');
        }

        // Interview Evaluation Function
        async function evaluateAnswer() {
            const question = document.getElementById('interviewQuestion').value;
            const answer = document.getElementById('interviewAnswer').value;
            const role = document.getElementById('interviewRole').value;
            const level = document.getElementById('interviewLevel').value;

            if (!question.trim() || !answer.trim()) {
                alert('Please enter both question and answer');
                return;
            }

            showLoading('interview');
            try {
                const response = await fetch('/api/interview/answer-check', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        question: question,
                        candidateAnswer: answer,
                        role: role,
                        level: level
                    })
                });

                const result = await response.json();
                document.getElementById('interviewResponse').textContent = JSON.stringify(result, null, 2);
            } catch (error) {
                document.getElementById('interviewResponse').textContent = 'Error: ' + error.message;
            }
            hideLoading('interview');
        }
    </script>
</body>
</html>
